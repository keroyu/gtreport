(function(){var a,t,e;t=$("#reportSN").val(),a=function(){var a,e,s;s=$("#tasksTable").width(),a=$("#tasksTable").height(),e=.4*a,a=.6*a,$("#tasksTable").prepend('<div class="text-center ajax-loader" style="height:'+a+"px; padding-top:"+e+'px; "><img src="/img/loader.gif" ></div>'),setTimeout(function(){$("#tasksTable").load("/ajax/reportTable/"+t)},800)},a(),$("#designer").focus(function(){$("#nameBox").show()}),$("input:not(#designer)").focus(function(){$("#nameBox").hide()}),$("#nameBox ul li").click(function(){var a,t;t=$(this).html(),a=$("#designer").val(),""!==a?$("#designer").val(a+"、"+t):$("#designer").val(t),$("#designer").focus()}),$("#addNewTask").click(function(){var e,s,r,d,n,i,o,l,c;t=$("#reportSN").val(),d=$("#pjSN").val(),o=$("#taskName").val(),l=$("#type").val(),n=$("#progress").val(),i=$("#status").val(),r=$("#designer").val(),e=$("#cowork").val(),c=$("#url").val(),""!==d&&""!==o&&""!==l&&""!==n&&""!==r?(s={reportSN:t,pjSN:d,taskName:o,type:l,progress:n,status:i,designer:r,cowork:e,url:c},$.ajax({url:"/ajax/taskQuery/add",data:s,type:"POST",success:function(t){$("#addNewTask").after('<div class="text-center" id="res">'+t+"</div>"),$("#res").delay(1500).fadeOut("slow"),$("#taskName, #status, #cowork, #url").html(""),a()}})):($("#addNewTask").after('<div class="alert text-center">必要資料未填寫完成!</div>'),$(".alert").delay(1500).fadeOut("slow"))}),e=["TaskName","TaskProgress","TaskStatus","TaskDesigner","TaskCowork","TaskUrl"],$("body").on("click",".manageTask",function(){var a,t,s,r,d,n,i,o,l,c,k;for(n=$(this).data("task"),r=$(this).data("pj"),o=$(this).data("type"),t="<td>auto</td>",i=[],s=0;6>s;)i.push($("#td"+e[s]+n).html()),t+='<td><input type="text" class="md" id="edit'+e[s]+n+'" val=""></td>',s++;for(l=["W","P","M"],k=["網頁","平面","多媒體"],c='<select name="editTaskType'+n+'" id="editTaskType'+n+'">',d="",s=0;3>s;)c+='<option value="'+l[s]+'"',o===l[s]&&(c+=" selected"),c+=">"+k[s]+"</option>",s++;for(c+="</select>",a='<tr class="text-right edit-area'+n+'"><td colspan="7"><span class="margin-rl" id="taskResponse'+n+'"></span><span>專案類型：'+c+'</span> <button class="btn xs primary editTaskBtn" data-task="'+n+'" data-pj="'+r+'" data-type="'+o+'">修改</button> <button class="btn xs danger delTaskBtn" data-task="'+n+'">刪除</button> <button class="btn xs cancelTaskBtn" data-task="'+n+'">取消</button></td></tr>',$("#task"+n).after('<tr class="pj-dt-ct edit-area'+n+'" id="edit'+n+'"></tr>'),$("#edit"+n).append(t).after(a),s=0;6>s;)$("#edit"+e[s]+n).val(i[s]),s++;setTimeout(function(){$("#task"+n).hide()},50)}),$("body").on("click",".editTaskBtn",function(){var s,r,d,n,i,o;for(t=$("#reportSN").val(),i=$(this).data("task"),d=$(this).data("pj"),o=$("#editTaskType"+i).val(),n=[],r=0;6>r;)n[e[r]]=$("#edit"+e[r]+i).val(),r++;s={reportSN:t,taskSN:i,pjSN:d,taskName:n.TaskName,type:o,progress:n.TaskProgress,status:n.TaskStatus,designer:n.TaskDesigner,cowork:n.TaskCowork,url:n.TaskUrl},$.ajax({url:"/ajax/taskQuery/edit",data:s,type:"POST",success:function(t){$("#taskResponse"+i).html(t),$("#res").delay(1e3).fadeOut("fast"),setTimeout(a(),3e3)}})}),$("body").on("click",".cancelTaskBtn",function(){var a;a=$(this).data("task"),$(".edit-area"+a).remove(),$("#task"+a).show()}),$("body").on("click",".delTaskBtn",function(){var t,e;e=$(this).data("task"),t=$("#editTaskName"+e).val(),console.log(e,t),confirm('確定刪除專案 "'+t+'" 嗎?')&&$.ajax({url:"/ajax/taskQuery/del",data:{taskSN:e},type:"POST",success:function(t){$("#taskResponse"+e).html(t),$("#res").delay(1e3).fadeOut("fast"),setTimeout(a(),2e3)}})})}).call(this);